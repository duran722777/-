<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>리밸런싱 복리 계산기</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- 구글 애드센스 광고 -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4634078773523032"
     crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background: #f5f5f5;
      font-family: 'Segoe UI', 'Apple SD Gothic Neo', Arial, sans-serif;
      color: #333;
    }
    .container {
      max-width: 400px;
      margin: 40px auto;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #444;
      margin-bottom: 20px;
      font-size: 1.6em;
      font-weight: 600;
    }
    input, select, button {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      font-size: 1em;
    }
    button {
      background: #4CAF50;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover { background: #45a049; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      font-size: 0.95em;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 6px;
      text-align: center;
    }
    th {
      background: #f0f0f0;
      font-weight: 600;
    }
    .ads {
      text-align: center;
      margin: 20px auto;
      max-width: 320px;
    }
    canvas {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="ads">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-4634078773523032"
         data-ad-slot="8919515384"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

  <div class="container">
    <h1>리밸런싱 복리 계산기</h1>
    <label>초기 투자금</label>
    <input type="number" id="initial" value="1000000">
    
    <label>기간 단위</label>
    <select id="periodType">
      <option value="month">월별</option>
      <option value="year">연별</option>
    </select>
    
    <label>기간 (개월/년)</label>
    <input type="number" id="duration" value="12">
    
    <label>매달/연 투자 금액</label>
    <input type="number" id="contribution" value="100000">
    
    <label>수익률 (%)</label>
    <input type="number" id="rate" value="5">
    
    <label>리밸런싱 비율 (%)</label>
    <input type="number" id="rebalanceRate" value="15">
    
    <button onclick="calculate()">계산하기</button>

    <table id="resultTable">
      <thead>
        <tr>
          <th>기간</th>
          <th>리밸 전 주식</th>
          <th>리밸 후 주식</th>
          <th>현금</th>
          <th>총 자산</th>
          <th>매달/연 수익</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <canvas id="chart" width="350" height="200"></canvas>
  </div>

  <div class="ads">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-4634078773523032"
         data-ad-slot="8919515384"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

<script>
function calculate() {
  const initial = parseFloat(document.getElementById('initial').value);
  const duration = parseInt(document.getElementById('duration').value);
  const contribution = parseFloat(document.getElementById('contribution').value);
  const rate = parseFloat(document.getElementById('rate').value)/100;
  const rebalanceRate = parseFloat(document.getElementById('rebalanceRate').value)/100;
  const periodType = document.getElementById('periodType').value;
  const tableBody = document.querySelector('#resultTable tbody');
  tableBody.innerHTML = '';
  
  let stock = initial;
  let cash = 0;
  let total = initial;
  let monthlyProfit = 0;
  let labels = [];
  let data = [];
  
  for (let i=1; i<=duration; i++) {
    let preRebalanceStock = stock;

    // 수익 적용
    stock *= 1 + rate;

    // 매달/연 투자
    stock += contribution;

    // 리밸런싱
    let rebalanceAmount = stock * rebalanceRate;
    stock -= rebalanceAmount;
    cash += rebalanceAmount;

    total = stock + cash;
    monthlyProfit = total - (initial + contribution*i);

    // 테이블 추가
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${i} ${periodType === 'month' ? '개월' : '년'}</td>
      <td>${preRebalanceStock.toFixed(0)}</td>
      <td>${stock.toFixed(0)}</td>
      <td>${cash.toFixed(0)}</td>
      <td>${total.toFixed(0)}</td>
      <td>${monthlyProfit.toFixed(0)}</td>
    `;
    tableBody.appendChild(row);

    labels.push(i);
    data.push(total.toFixed(0));
  }

  // 차트 생성
  const ctx = document.getElementById('chart').getContext('2d');
  if (window.myChart) window.myChart.destroy();
  window.myChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: '총 자산(Total Assets)',
        data: data,
        borderColor: '#4CAF50',
        fill: false,
        tension: 0.2
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: true } },
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
}
</script>
</body>
</html>
