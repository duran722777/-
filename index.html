<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>주식 복리 계산기 + 리밸런싱</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- 구글 애드센스 -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4634078773523032"
     crossorigin="anonymous"></script>
<style>
  body { font-family: 'Segoe UI', 'Apple SD Gothic Neo', Arial, sans-serif; background: #fdf6fb; margin: 0; padding: 0;}
  .container { max-width: 420px; margin: 40px auto; padding: 20px; background: #fff7f0; border-radius: 16px; box-shadow: 0 2px 16px rgba(211, 183, 255, 0.15);}
  h1 { text-align:center; color:#8c8cff; margin-bottom:20px;}
  label { display:block; margin:8px 0 4px; font-weight:500;}
  input { width: 100%; padding: 8px; margin-bottom:10px; border-radius:6px; border:1px solid #e6cfff; box-sizing:border-box;}
  button { width: 100%; padding:10px; background:#8c8cff; color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600; margin-top:10px;}
  table { width:100%; border-collapse: collapse; margin-top:20px;}
  th, td { border:1px solid #ccc; padding:6px; text-align:right;}
  th { background:#f3f3fd; }
  .ads { margin: 20px auto; text-align:center; }
</style>
</head>
<body>

<div class="container">
  <h1>복리 + 리밸런싱 계산기</h1>

  <!-- 입력 -->
  <label>초기 투자금</label>
  <input type="number" id="initial" value="1000000">

  <label>매달 추가 투자금</label>
  <input type="number" id="monthly" value="100000">

  <label>투자 기간 (개월)</label>
  <input type="number" id="months" value="24">

  <label>월평균 수익률 (%)</label>
  <input type="number" id="rate" value="1">

  <label>리밸런싱 비율 (%)</label>
  <input type="number" id="rebalance" value="15">

  <button onclick="calculate()">계산하기</button>

  <!-- 광고 -->
  <div class="ads">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-4634078773523032"
         data-ad-slot="8919515384"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>

  <!-- 결과 표 -->
  <div id="result"></div>

  <!-- 그래프 -->
  <canvas id="chart" width="400" height="200"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
function calculate() {
  const initial = parseFloat(document.getElementById('initial').value);
  const monthly = parseFloat(document.getElementById('monthly').value);
  const months = parseInt(document.getElementById('months').value);
  const rate = parseFloat(document.getElementById('rate').value)/100;
  const rebalancePercent = parseFloat(document.getElementById('rebalance').value)/100;

  let data = [];
  let monthLabels = [];
  let total = initial;
  let stock = initial;
  let cash = 0;

  for(let m=1;m<=months;m++){
    stock = stock*(1+rate) + monthly;
    cash += monthly;

    // 리밸런싱
    let targetStock = (stock+cash)*(1-rebalancePercent);
    let targetCash = (stock+cash)*rebalancePercent;
    let sold = stock - targetStock;
    stock = targetStock;
    cash = targetCash;

    total = stock + cash;
    data.push(total.toFixed(0));
    monthLabels.push('월'+m);
  }

  // 표 생성
  let html = `<table><tr><th>월</th><th>주식금액</th><th>현금</th><th>총자산</th></tr>`;
  for(let i=0;i<months;i++){
    html += `<tr><td>${i+1}</td><td>${(data[i]* (1-rebalancePercent)).toFixed(0)}</td><td>${(data[i]*rebalancePercent).toFixed(0)}</td><td>${data[i]}</td></tr>`;
  }
  html += `</table>`;
  document.getElementById('result').innerHTML = html;

  // 그래프
  const ctx = document.getElementById('chart').getContext('2d');
  if(window.chart) window.chart.destroy();
  window.chart = new Chart(ctx, {
    type:'line',
    data:{
      labels: monthLabels,
      datasets:[{label:'총자산', data:data, borderColor:'#8c8cff', fill:false}]
    }
  });
}
</script>
</body>
</html>
